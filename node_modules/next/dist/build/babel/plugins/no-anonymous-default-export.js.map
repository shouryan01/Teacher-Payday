{"version":3,"sources":["../../../../build/babel/plugins/no-anonymous-default-export.ts"],"sourcesContent":["import { PluginObj, types as BabelTypes } from 'next/dist/compiled/babel/core'\nimport chalk from 'chalk'\n\nexport default function NoAnonymousDefaultExport({\n  types: t,\n  ...babel\n}: {\n  types: typeof BabelTypes\n  caller: (callerCallback: (caller: any) => any) => any\n}): PluginObj<any> {\n  let onWarning: ((reason: string | Error) => void) | null = null\n  babel.caller((caller) => {\n    onWarning = caller.onWarning\n    return '' // Intentionally empty to not invalidate cache\n  })\n\n  if (typeof onWarning !== 'function') {\n    return { visitor: {} }\n  }\n\n  const warn = onWarning! as any /* blitz */\n  return {\n    visitor: {\n      ExportDefaultDeclaration(path) {\n        const def = path.node.declaration\n\n        if (\n          !(\n            def.type === 'ArrowFunctionExpression' ||\n            def.type === 'FunctionDeclaration'\n          )\n        ) {\n          return\n        }\n\n        switch (def.type) {\n          case 'ArrowFunctionExpression': {\n            if (\n              !process.env.__NEXT_TEST_MODE ||\n              !!process.env.__NEXT_TEST_ANON_EXPORT\n            ) {\n              warn(\n                [\n                  chalk.yellow.bold(\n                    'Anonymous arrow functions cause Fast Refresh to not preserve local component state.'\n                  ),\n                  'Please add a name to your function, for example:',\n                  '',\n                  chalk.bold('Before'),\n                  chalk.cyan('export default () => <div />;'),\n                  '',\n                  chalk.bold('After'),\n                  chalk.cyan('const Named = () => <div />;'),\n                  chalk.cyan('export default Named;'),\n                  '',\n                  `A codemod is available to fix the most common cases: ${chalk.cyan(\n                    'https://nextjs.link/codemod-ndc'\n                  )}`,\n                ].join('\\n')\n              )\n            }\n            break\n          }\n          case 'FunctionDeclaration': {\n            const isAnonymous = !Boolean(def.id)\n            if (\n              isAnonymous &&\n              (!process.env.__NEXT_TEST_MODE ||\n                !!process.env.__NEXT_TEST_ANON_EXPORT)\n            ) {\n              warn(\n                [\n                  chalk.yellow.bold(\n                    'Anonymous function declarations cause Fast Refresh to not preserve local component state.'\n                  ),\n                  'Please add a name to your function, for example:',\n                  '',\n                  chalk.bold('Before'),\n                  chalk.cyan('export default function () { /* ... */ }'),\n                  '',\n                  chalk.bold('After'),\n                  chalk.cyan('export default function Named() { /* ... */ }'),\n                  '',\n                  `A codemod is available to fix the most common cases: ${chalk.cyan(\n                    'https://nextjs.link/codemod-ndc'\n                  )}`,\n                ].join('\\n')\n              )\n            }\n            break\n          }\n          default: {\n            // eslint-disable-next-line @typescript-eslint/no-unused-vars\n            const _: never = def\n          }\n        }\n      },\n    },\n  }\n}\n"],"names":[],"mappings":";;;;kBAGwB,wBAAwB;AAF9B,GAAO,CAAP,MAAO;;;;;;SAED,wBAAwB,GAC9C,KAAK,EAAE,CAAC,MACL,KAAK,IAIS,CAAC;IAClB,GAAG,CAAC,SAAS,GAA8C,IAAI;IAC/D,KAAK,CAAC,MAAM,EAAE,MAAM,GAAK,CAAC;QACxB,SAAS,GAAG,MAAM,CAAC,SAAS;iBAClB,CAA8C,AAA9C,EAA8C,AAA9C,4CAA8C;;IAC1D,CAAC;IAED,EAAE,SAAS,SAAS,MAAK,QAAU,GAAE,CAAC;;YAC3B,OAAO;;;IAClB,CAAC;IAED,KAAK,CAAC,IAAI,GAAG,SAAS,AAAS,EAAW,AAAX,OAAW,AAAX,EAAW;;QAExC,OAAO;YACL,wBAAwB,EAAC,IAAI,EAAE,CAAC;gBAC9B,KAAK,CAAC,GAAG,GAAG,IAAI,CAAC,IAAI,CAAC,WAAW;gBAEjC,EAAE,IAEE,GAAG,CAAC,IAAI,MAAK,uBAAyB,KACtC,GAAG,CAAC,IAAI,MAAK,mBAAqB,IAEpC,CAAC;;gBAEH,CAAC;uBAEO,GAAG,CAAC,IAAI;0BACT,uBAAyB;wBAAE,CAAC;4BAC/B,EAAE,GACC,OAAO,CAAC,GAAG,CAAC,gBAAgB,MAC3B,OAAO,CAAC,GAAG,CAAC,uBAAuB,EACrC,CAAC;gCACD,IAAI;oCAxCA,MAAO,SA0CD,MAAM,CAAC,IAAI,EACf,mFAAqF;qCAEvF,gDAAkD;;oCA7ClD,MAAO,SA+CD,IAAI,EAAC,MAAQ;oCA/CnB,MAAO,SAgDD,IAAI,EAAC,6BAA+B;;oCAhD1C,MAAO,SAkDD,IAAI,EAAC,KAAO;oCAlDlB,MAAO,SAmDD,IAAI,EAAC,4BAA8B;oCAnDzC,MAAO,SAoDD,IAAI,EAAC,qBAAuB;;qCAEjC,qDAAqD,EAtDtD,MAAO,SAsDuD,IAAI,EAChE,+BAAiC;kCAEnC,IAAI,EAAC,EAAI;4BAEf,CAAC;;wBAEH,CAAC;0BACI,mBAAqB;wBAAE,CAAC;4BAC3B,KAAK,CAAC,WAAW,IAAI,OAAO,CAAC,GAAG,CAAC,EAAE;4BACnC,EAAE,EACA,WAAW,MACT,OAAO,CAAC,GAAG,CAAC,gBAAgB,MAC1B,OAAO,CAAC,GAAG,CAAC,uBAAuB,GACvC,CAAC;gCACD,IAAI;oCArEA,MAAO,SAuED,MAAM,CAAC,IAAI,EACf,yFAA2F;qCAE7F,gDAAkD;;oCA1ElD,MAAO,SA4ED,IAAI,EAAC,MAAQ;oCA5EnB,MAAO,SA6ED,IAAI,EAAC,wCAA0C;;oCA7ErD,MAAO,SA+ED,IAAI,EAAC,KAAO;oCA/ElB,MAAO,SAgFD,IAAI,EAAC,6CAA+C;;qCAEzD,qDAAqD,EAlFtD,MAAO,SAkFuD,IAAI,EAChE,+BAAiC;kCAEnC,IAAI,EAAC,EAAI;4BAEf,CAAC;;wBAEH,CAAC;;wBACQ,CAAC;4BACR,EAA6D,AAA7D,2DAA6D;4BAC7D,KAAK,CAAC,CAAC,GAAU,GAAG;wBACtB,CAAC;;YAEL,CAAC;;;AAGP,CAAC"}